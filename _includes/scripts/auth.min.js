async function loginUser(email,password){try{const response=await fetch("http://media.maar.world:3001/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:email,password:password})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||"Login failed. Please try again.")}const data=await response.json();console.log("Login response:",data),localStorage.setItem("userId",data.userId),updateAuthLink(!0)}catch(error){console.error("Login error:",error);const messageElement=document.getElementById("message");messageElement&&(messageElement.innerText=error.message,messageElement.style.color="red")}}async function forgotPassword(email){try{const response=await fetch("http://media.maar.world:3001/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:email})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||"Password reset failed")}console.log("Password reset email sent to:",email);const messageElement=document.getElementById("message");messageElement&&(messageElement.innerText="Password reset email sent! Please check your inbox.",messageElement.style.color="green")}catch(error){console.error("Password reset error:",error);const messageElement=document.getElementById("message");messageElement&&(messageElement.innerText="Password reset failed. Please try again.",messageElement.style.color="red")}}async function checkAuth(){try{const response=await fetch("http://media.maar.world:3001/api/auth/check-session",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(response.ok){return null!==(await response.json()).user}return console.warn("Session check failed:",response.status),!1}catch(error){return console.error("Error during authentication check:",error),!1}}async function logoutUser(){try{if(!(await fetch("http://media.maar.world:3001/api/auth/logout",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Logout failed");localStorage.clear(),updateAuthLink(!1),window.location.href="/login"}catch(error){console.error("Logout error:",error),alert("Logout failed. Please try again.")}}function updateAuthLink(isLoggedIn){const authLink=document.getElementById("auth-link");authLink&&(isLoggedIn?(authLink.innerHTML='<span class="material-symbols-outlined">logout</span> Logout',authLink.onclick=event=>{event.preventDefault(),logoutUser()},authLink.href="#"):(authLink.innerHTML='<span class="material-symbols-outlined">login</span> Login',authLink.onclick=null,authLink.href="/login"))}function initializeAuth(){checkAuth()}document.addEventListener("DOMContentLoaded",initializeAuth),window.loginUser=loginUser,window.logoutUser=logoutUser,window.forgotPassword=forgotPassword,window.checkAuth=checkAuth;