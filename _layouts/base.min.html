<!DOCTYPE html> {%- include snippets/get-lang.html -%} <html lang="{{ __return }}"> <head> {%- include analytics.html -%} {%- include head.html -%} <script> {%- include scripts/utils/utils.js -%}
      {%- include scripts/lib/throttle.js -%}
      {%- include scripts/lib/lazyload.js -%} </script> {%- include scripts/variables.html -%} {%- include scripts/cookie-consent.html -%} </head> <body> <div class="root" data-is-touch="false"> {{ content }} </div> <script> //    {%- include scripts/cacheUtils.js -%}
      {%- include scripts/common.js -%}
      {%- include scripts/searchUsers.js -%} </script> <script>const API_BASE="http://media.maar.world:3001";async function checkSession(){try{const e=await fetch(`${API_BASE}/api/auth/check-session`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});console.log("Check Session Response Status:",e.status),console.log("Check Session Response Headers:",e.headers);const o=await e.json();if(e.ok)if(o.user){const e=o.user.username||o.user.email;localStorage.setItem("userId",o.user.userId),localStorage.setItem("username",e),updateAuthLink(!0),console.log("Session is valid:",o.user)}else updateAuthLink(!1),console.log("No user data found.");else updateAuthLink(!1),console.warn("Session check failed, user is not logged in.")}catch(e){console.error("Error during session check:",e),updateAuthLink(!1)}}function redirectToLogin(e){console.error(e),window.location.href="/login"}async function logoutUser(){try{if(!(await fetch(`${API_BASE}/api/auth/logout`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Logout failed");localStorage.clear(),updateAuthLink(!1),window.location.href="/login"}catch(e){console.error("Logout error:",e)}}function updateAuthLink(e){const o=document.getElementById("auth-link");o&&(e?(o.innerHTML='<span class="material-symbols-outlined">logout</span> Logout',o.onclick=logoutUser):(o.innerHTML='<span class="material-symbols-outlined">login</span> Login',o.href="/login"))}</script> 